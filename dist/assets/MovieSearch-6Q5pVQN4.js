import{r as t,c as j,s as y,i as I,a as L,j as s,F as m,z as R,A as C}from"./index-XMF6nw69.js";import{M as T,I as $,S as z,a as A,E as M,b,c as w,d as N}from"./styledComponents-4f0GTOQO.js";import{T as F}from"./Title-nZA67SrN.js";function q(){const[n,f]=t.useState(""),[a,h]=t.useState(),[c,p]=t.useState(),[i,u]=t.useState(),[E,S]=t.useState(!1),r=j(y),l=t.useRef(),x=t.useRef(),g=I(),d=t.useCallback(async(e,o)=>{if(e)try{const k={headers:{Authorization:`bearer ${o}`}},v=await L.get(`/api/movies/search?search=${e}`,k);v.data.results.length<1?u("Nothing found"):u(""),p(v.data.results)}catch{u("Nothing found")}},[]);return t.useEffect(()=>{const e=setTimeout(()=>S(!0),1e3);return()=>clearTimeout(e)},[]),t.useEffect(()=>{a&&setTimeout(()=>x.current.focus(),0)},[a,f]),t.useEffect(()=>{function e(o){l.current&&!l.current.contains(o.target)&&h(!1)}return document.addEventListener("click",e),()=>document.removeEventListener("click",e)},[]),t.useEffect(()=>{r||g(-1)},[r,g]),t.useEffect(()=>{function e(o){n&&a&&o.key==="Enter"&&d(n,r.token)}return document.addEventListener("keypress",e),()=>document.removeEventListener("keypress",e)},[a,r.token,n,d]),s.jsxs(T,{$loaded:E,children:[s.jsx(F,{text:"search for movies"}),s.jsxs($,{ref:l,children:[s.jsx(z,{onClick:()=>h(!0),children:s.jsx(m,{icon:R,color:"gold",style:{fontSize:"20px",zIndex:3}})}),s.jsx(A,{id:"search",name:"search",type:"text",ref:x,$active:a,value:n,onChange:e=>f(e.target.value)}),s.jsx(M,{$active:a,disabled:(n==null?void 0:n.length)<1,onClick:()=>{n&&d(n,r.token)},children:s.jsx(m,{icon:C,color:"gold",style:{fontSize:"20px"}})})]}),(i==null?void 0:i.length)>0&&s.jsx(b,{children:i}),(c==null?void 0:c.length)>0&&s.jsx(w,{children:c.map(e=>s.jsxs(N,{to:`/detailed-movie/${e.id}`,children:[e.title," (",e.release_date.slice(0,4),")"]},e.id))})]})}export{q as default};
