import{r as t,c as j,s as y,i as I,a as L,j as s,F as m,A as R,B as C}from"./index-aB-pfHqH.js";import{M as T,I as $,S as b,a as A,E as M,b as z,c as w,d as N}from"./styledComponents-ZhhTSSiX.js";import{T as B}from"./Title-il1DVEMI.js";function q(){const[a,f]=t.useState(""),[n,h]=t.useState(),[c,p]=t.useState(),[i,l]=t.useState(),[E,S]=t.useState(!1),r=j(y),u=t.useRef(),x=t.useRef(),g=I(),d=t.useCallback(async(e,o)=>{if(e)try{const k={headers:{Authorization:`bearer ${o}`}},v=await L.get(`/api/movies/search?search=${e}`,k);v.data.results.length<1?l("Nothing found"):l(""),p(v.data.results)}catch{l("Nothing found")}},[]);return t.useEffect(()=>{const e=setTimeout(()=>S(!0),1e3);return()=>clearTimeout(e)},[]),t.useEffect(()=>{n&&setTimeout(()=>x.current.focus(),0)},[n,f]),t.useEffect(()=>{function e(o){u.current&&!u.current.contains(o.target)&&h(!1)}return document.addEventListener("click",e),()=>document.removeEventListener("click",e)},[]),t.useEffect(()=>{r||g(-1)},[r,g]),t.useEffect(()=>{function e(o){a&&n&&o.key==="Enter"&&d(a,r.token)}return document.addEventListener("keypress",e),()=>document.removeEventListener("keypress",e)},[n,r.token,a,d]),s.jsxs(T,{$loaded:E,children:[s.jsx(B,{text:"search for movies"}),s.jsxs($,{ref:u,children:[s.jsx(b,{onClick:()=>h(!0),children:s.jsx(m,{icon:R,color:"gold",style:{fontSize:"20px",zIndex:3}})}),s.jsx(A,{id:"search",name:"search",type:"text","aria-label":"find a movie",ref:x,$active:n,value:a,onChange:e=>f(e.target.value)}),s.jsx(M,{$active:n,disabled:(a==null?void 0:a.length)<1,onClick:()=>{a&&d(a,r.token)},children:s.jsx(m,{icon:C,color:"gold",style:{fontSize:"20px"}})})]}),(i==null?void 0:i.length)>0&&s.jsx(z,{children:i}),(c==null?void 0:c.length)>0&&s.jsx(w,{children:c.map(e=>s.jsxs(N,{to:`/detailed-movie/${e.id}`,children:[e.title," (",e.release_date.slice(0,4),")"]},e.id))})]})}export{q as default};
